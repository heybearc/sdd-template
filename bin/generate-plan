#!/usr/bin/env bash
set -euo pipefail
BR="$(git branch --show-current)"
DIR="specs/${BR}"
[ -d "$DIR" ] || { echo "Expected to run on feature branch '${BR}' with matching specs dir ${DIR}"; exit 1; }
cat > "${DIR}/implementation-plan.md" <<'MD'
## Phase –1 Gates (MUST PASS)
- Simplicity (Art. VII): ≤3 projects? no future-proofing?
- Anti-Abstraction (Art. VIII): framework features direct? single model?
- Integration-First (Art. IX): contracts defined? contract tests written?
- TDD (Art. III): tests authored & failing?

## Architecture / Decisions
- ...

## File Creation Order
1) contracts/
2) tests: contract → integration → e2e → unit
3) src/ (write just enough code to pass tests)
MD
mkdir -p "${DIR}/implementation-details"
echo "# Tasks" > "${DIR}/tasks.md"
echo "- [ ] Derive contracts from Examples" >> "${DIR}/tasks.md"
echo "- [ ] Write contract tests (failing)" >> "${DIR}/tasks.md"
echo "- [ ] Add unit/integration tests (failing)" >> "${DIR}/tasks.md"
echo "- [ ] Implement minimal code to pass" >> "${DIR}/tasks.md"
echo "Created ${DIR}/implementation-plan.md and tasks.md"
